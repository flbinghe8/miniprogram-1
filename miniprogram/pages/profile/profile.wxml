<!-- pages/profile/profile.wxml - å®Œæ•´ä¿®å¤ç‰ˆ -->
<view wx:if="{{showLoginButton}}" class="login-section">
  <view class="login-card">
    <text class="login-title">æœªç™»å½•</text>
    <text class="login-desc">ç™»å½•åäº«å—3æ¬¡å…è´¹è¯•ç”¨</text>
    <button class="login-button" bindtap="handleLogin">å¾®ä¿¡ä¸€é”®ç™»å½•</button>
  </view>
</view>

<view class="container">
  <!-- å¤´éƒ¨ï¼šä¼šå‘˜çŠ¶æ€ä¸é¢åº¦ -->
  <view class="profile-header">
    <view class="user-info">
      <!-- ç‚¹å‡»å¤´åƒå¼¹å‡ºåŠŸèƒ½èœå• -->
      <view class="avatar-placeholder" catchtap="onCreditCardTap">ğŸ‘¤</view>
      <view class="nickname">{{ userProfile.nickname }}</view>
    </view>
    
    <!-- é¢åº¦ä¿¡æ¯å¡ç‰‡ -->
    <view class="membership-card credit-card">
      <view class="status-section">
        <view class="card-header">
          <text class="status-title card-title">å½“å‰é¢åº¦</text>
        </view>
        <text class="status-value credit-count">{{ userProfile.credits }}</text>
        <text class="package-info" wx:if="{{userProfile.packageInfo}}">{{userProfile.packageInfo}}</text>
      </view>
      
      <!-- å‡çº§æŒ‰é’® -->
      <button class="upgrade-btn" catchtap="goToMembership">
        å‡çº§ä¼šå‘˜ / æŸ¥çœ‹å¥—é¤
      </button>
    </view>
  </view>

  <!-- èœå•åˆ—è¡¨ -->
  <view class="menu-list">
    <view class="menu-item" bindtap="goToHistory">
      <text class="menu-text">å†å²ç”Ÿæˆè®°å½•</text>
      <text class="menu-arrow">></text>
    </view>
    
    <view class="menu-item" bindtap="goToGuide">
      <text class="menu-text">ä½¿ç”¨æŒ‡å¼• / æ·»åŠ åˆ°æ¡Œé¢</text>
      <text class="menu-arrow">></text>
    </view>
    
    <view class="menu-item" bindtap="contactCustomerService">
      <text class="menu-text">è”ç³»å®¢æœ</text>
      <text class="menu-arrow">></text>
    </view>
    
    <view class="menu-item" bindtap="logout">
      <text class="menu-text">é€€å‡ºç™»å½•</text>
      <text class="menu-arrow">></text>
    </view>
  </view>
  
  <view class="app-version">Version 1.3.0</view>
</view>

<!-- é¢åº¦æ˜ç»†å¼¹çª— -->
<view class="quota-popup" wx:if="{{showQuotaPopup}}">
  <view class="popup-mask" catchtap="onCloseQuotaPopup"></view>
  <view class="popup-content">
    
    <!-- æ ‡é¢˜ -->
    <view class="popup-header">
      <text class="popup-title">é¢åº¦æ˜ç»†</text>
      <text class="popup-close" catchtap="onCloseQuotaPopup">Ã—</text>
    </view>
    
    <!-- æ ¸å¿ƒé¢åº¦ä¿¡æ¯ -->
    <view class="quota-card">
      <view class="quota-main">
        <text class="quota-count">{{quotaData.availableTimes}}</text>
        <text class="quota-unit">æ¬¡</text>
      </view>
      <text class="quota-desc">å‰©ä½™æ€»æ¬¡æ•°</text>
    </view>
    
    <!-- é¢åº¦è¯¦æƒ… -->
    <view class="quota-details">
      <view class="detail-item">
        <text class="detail-label">è¯•ç”¨å‰©ä½™</text>
        <text class="detail-value">{{quotaData.trialRemaining}}/{{quotaData.totalTrials}}æ¬¡</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">ä»˜è´¹å‰©ä½™</text>
        <text class="detail-value">{{quotaData.paidRemaining}}æ¬¡</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">å·²ç”¨æ¬¡æ•°</text>
        <text class="detail-value">{{quotaData.usedTimes}}æ¬¡</text>
      </view>
      <view class="detail-item" wx:if="{{quotaData.isMember}}">
        <text class="detail-label">ä¼šå‘˜çŠ¶æ€</text>
        <text class="detail-value member">å‰©ä½™{{quotaData.daysRemaining}}å¤©</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">å¥—é¤ç±»å‹</text>
        <text class="detail-value">{{quotaData.packageType}}</text>
      </view>
    </view>
    
    <!-- æœ€è¿‘ä½¿ç”¨è®°å½• -->
    <view class="recent-records" wx:if="{{quotaData.recentRecords && quotaData.recentRecords.length > 0}}">
      <text class="records-title">æœ€è¿‘ä½¿ç”¨è®°å½•</text>
      <view class="record-list">
        <view class="record-item" wx:for="{{quotaData.recentRecords}}" wx:for-item="record" wx:key="index">
          <text class="record-action">{{record.action}}</text>
          <text class="record-date">{{record.date}}</text>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-records" wx:if="{{!quotaData.recentRecords || quotaData.recentRecords.length === 0}}">
      <text>æš‚æ— ä½¿ç”¨è®°å½•</text>
    </view>
    
  </view>
</view>